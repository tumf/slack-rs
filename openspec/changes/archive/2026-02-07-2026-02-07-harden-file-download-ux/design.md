# 設計メモ: file download UX 強化

## 方針
- 既存の `file download` 実行経路を維持し、HTTP 応答処理の要件だけを強化する。
- 仕様上の変更は `wrapper-commands` の既存 Requirement を `MODIFIED` で更新する。

## 変更点
### 1) リダイレクト追従の明確化
- ダウンロード HTTP GET は 3xx を自動追従することを要件化する。
- 追従結果が最終的に非2xxなら既存エラー要件に従って失敗終了する。

### 2) HTML 応答時の診断情報
- `Content-Type: text/html` の場合、既存の「URL/認証ミスのヒント」に加えて、本文先頭の短い断片を安全に提示する。
- スニペットは過度に長い情報を出さないよう短く切り詰める前提とし、機微情報の過剰露出を避ける。

## トレードオフ
- 断片表示は診断性を上げる一方でログ露出リスクがあるため、短尺・整形済みの最小情報に制限する。
- リダイレクト追従により期待成功率は上がるが、最終到達先のエラーは明示的に失敗させることで安全側に倒す。

## 検証戦略
- モック HTTP サーバーで 302 -> 200 の経路を再現し、追従して保存成功することを確認する。
- HTML 応答モックで失敗終了、かつヒント + スニペットを stderr に含むことを確認する。
