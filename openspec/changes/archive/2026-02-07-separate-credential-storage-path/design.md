# 設計: 認証情報保存先の分離

## 設計方針
- 変更範囲は `FileTokenStore` のデフォルトパス解決と移行処理に限定する
- 既存インターフェース（`TokenStore` trait、キー形式、環境変数）を維持する
- 既存データは読み捨てせず自動移行で引き継ぐ

## パス方針
- 新デフォルト: `~/.local/share/slack-rs/tokens.json`
- 旧デフォルト: `~/.config/slack-rs/tokens.json`
- 明示設定: `SLACK_RS_TOKENS_PATH`（最優先）

優先順位:
1. `SLACK_RS_TOKENS_PATH`
2. 新デフォルトパス

## 移行方針
- `SLACK_RS_TOKENS_PATH` 未設定時のみ移行を考慮する
- 新パスが未存在かつ旧パスが存在する場合、旧ファイル内容を新パスへコピーする
- コピー後、読み込みは新パスを使用する
- 旧ファイルの削除は本提案では行わない（安全側）

## セキュリティ方針
- 新規作成・移行後の `tokens.json` は Unix で 0600 を適用する
- 既存の JSON 形式・キー形式を維持して互換性を確保する

## テスト方針（mock-first）
- 実ホームディレクトリを使わず一時ディレクトリでパス解決・移行を検証する
- `SLACK_RS_TOKENS_PATH` 指定時は移行処理が走らないことを検証する
- 旧パスにのみファイルがあるケースで、新パスへ内容が移ることを検証する
- 既存の set/get/delete と 0600 の回帰を確認する

## トレードオフ
- 旧ファイルを残すためディスク上に一時的に重複が生じる
- ただし誤削除を避ける安全性を優先する
